#EDSS 3 entro 10 anni (evento EDSS 5)
library("survival", lib.loc="C:/Program Files/R/R-3.1.2/library")

time <- c(1, 1, 1, 1, 1, 1, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8, 8, 8, 8, 8, 8, 8, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 16, 16, 18, 18, 18, 18, 18, 18, 20, 20, 10, 10, 10, 10, 10, 10, 10, 10, 12, 12, 12, 12, 12, 12, 12, 12, 12, 14, 14, 14, 14, 14, 14, 16, 16, 16, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 20, 20, 20, 20, 20, 22, 22, 24, 24, 24, 24, 26, 28, 30)
status <- c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0)


groups <- c(rep("GroupA",104), rep("GroupB",51))
pop <- data.frame(time, status, groups)
pop$groups <- factor(pop$groups)
fit <- survfit(Surv(time, status) ~ groups, data=pop)
summary(fit)

#Grafico fico-o
par(mar=c(5.1,5,4.1,2.1), mgp = c(5,0.6,0))
plot(fit, conf.int=F, col=c('lightblue','lightblue4'), lwd=2, xlab = 'Anni di malattia', ylab = 'Probabilitá EDSS < 5',xaxt = 'n', yaxt='n', ann=FALSE, mark.time=TRUE, mark = 1)
axis(1, cex.axis=0.7)
axis(2, at=seq(0,1,by=.2),labels=paste(100*seq(0,1,by=.2), "%") ,las=1, cex.axis=0.7)
mtext(side = 1, text = "Anni di malattia", line = 2, font = 2)
mtext(side = 2, text = "Probabilitá EDSS < 5", line = 2.7, font = 2)
title("EDSS 3 entro 10 anni (evento EDSS 5)", line = 0.5)

##Confronto le curve (Log-rank Test)
survdiff(Surv(time, status) ~ groups, data=pop)


******************************************************************************************************************************************************
